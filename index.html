<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trekantkalkulator</title>

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#4facfe,#00f2fe);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.calculator {
  background:white;
  padding:20px;
  border-radius:15px;
  width:90%;
  max-width:420px;
  box-shadow:0 10px 20px rgba(0,0,0,0.2);
  text-align:center;
}

#info {
  font-size:14px;
  margin-bottom:10px;
}

.inputs input {
  width:80%;
  padding:10px;
  margin:6px auto;
  border-radius:8px;
  border:1px solid #ccc;
  display:block;
  text-align:center;
  font-size:16px;
}

button {
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  background:#4caf50;
  color:white;
  font-size:16px;
  cursor:pointer;
}

button.clear { background:#f44336; }
button.dark { background:#444; }

#result {
  margin-top:10px;
  font-weight:bold;
}

svg {
  width:100%;
  height:240px;
  margin-top:10px;
}

/* DARK MODE */
body.dark {
  background: linear-gradient(135deg,#111,#333);
}
body.dark .calculator { background:#222; color:white; }
body.dark input { background:#333; color:white; border:1px solid #555; }
body.dark #info { color:#ccc; }
body.dark #result { color:#0f0; }
body.dark button { background:#555; }
body.dark button.clear { background:#f44336; }
body.dark button.dark { background:#888; }
</style>
</head>

<body>

<div class="calculator">

<button class="dark" onclick="toggleDarkMode()">游깿 Dark mode</button>

<h2>Trekantkalkulator</h2>

<p id="info">
Fyll inn minst <b>3 verdier</b> (sider og/eller vinkler), s친 beregnes resten automatisk.
</p>

<div class="inputs">
  <input id="a" placeholder="Side a">
  <input id="b" placeholder="Side b">
  <input id="c" placeholder="Side c">

  <input id="A" placeholder="Vinkel A (춿)">
  <input id="B" placeholder="Vinkel B (춿)">
  <input id="C" placeholder="Vinkel C (춿)">
</div>

<button onclick="solveTriangle()">Kalkuler</button>
<button class="clear" onclick="clearAll()">Slett alt</button>

<div id="result"></div>

<svg viewBox="0 0 300 220">
  <polygon id="triangle" fill="none" stroke="black" stroke-width="2"/>
  <text id="labelA"></text>
  <text id="labelB"></text>
  <text id="labelC"></text>
  <text id="sidea"></text>
  <text id="sideb"></text>
  <text id="sidec"></text>
</svg>

</div>

<script>
const aInput = document.getElementById("a");
const bInput = document.getElementById("b");
const cInput = document.getElementById("c");
const AInput = document.getElementById("A");
const BInput = document.getElementById("B");
const CInput = document.getElementById("C");
const result = document.getElementById("result");

function toggleDarkMode() {
  document.body.classList.toggle("dark");
}

function toRad(d){ return d*Math.PI/180; }
function toDeg(r){ return r*180/Math.PI; }

function cosRule(x,y,z){
  return toDeg(Math.acos((x*x+y*y-z*z)/(2*x*y)));
}
function sinRule(x,y,Z){
  return toDeg(Math.asin(x*Math.sin(toRad(Z))/y));
}

function format(x){
  return Number(x).toFixed(4);
}

function lockInputs(){
  [aInput,bInput,cInput,AInput,BInput,CInput].forEach(i=>i.disabled=true);
}

function unlockInputs(){
  [aInput,bInput,cInput,AInput,BInput,CInput].forEach(i=>i.disabled=false);
}

function drawTriangle(a,b,c,A,B,C){
  // Skaler sidene for SVG
  let scale = 180 / Math.max(a,b,c);

  let Ax = 50;
  let Ay = 180;

  let Bx = Ax + a * scale;
  let By = Ay;

  let Cx = Ax + b * scale * Math.cos(toRad(A));
  let Cy = Ay - b * scale * Math.sin(toRad(A));

  const triangle = document.getElementById("triangle");
  triangle.setAttribute("points", `${Ax},${Ay} ${Bx},${By} ${Cx},${Cy}`);

  document.getElementById("labelA").setAttribute("x", Ax-15);
  document.getElementById("labelA").setAttribute("y", Ay+15);
  document.getElementById("labelA").textContent = "A="+format(A)+"춿";

  document.getElementById("labelB").setAttribute("x", Bx+5);
  document.getElementById("labelB").setAttribute("y", By+15);
  document.getElementById("labelB").textContent = "B="+format(B)+"춿";

  document.getElementById("labelC").setAttribute("x", Cx-10);
  document.getElementById("labelC").setAttribute("y", Cy-10);
  document.getElementById("labelC").textContent = "C="+format(C)+"춿";

  document.getElementById("sidea").setAttribute("x", (Ax+Bx)/2);
  document.getElementById("sidea").setAttribute("y", Ay+30);
  document.getElementById("sidea").textContent = "a="+format(a);

  document.getElementById("sideb").setAttribute("x", (Ax+Cx)/2 - 10);
  document.getElementById("sideb").setAttribute("y", (Ay+Cy)/2);
  document.getElementById("sideb").textContent = "b="+format(b);

  document.getElementById("sidec").setAttribute("x", (Bx+Cx)/2 + 5);
  document.getElementById("sidec").setAttribute("y", (By+Cy)/2);
  document.getElementById("sidec").textContent = "c="+format(c);
}

function solveTriangle(){

  if (aInput.disabled) {
    result.innerText = "Trykk 'Slett alt' for 친 gj칮re en ny beregning.";
    return;
  }

  let a = parseFloat(aInput.value);
  let b = parseFloat(bInput.value);
  let c = parseFloat(cInput.value);
  let A = parseFloat(AInput.value);
  let B = parseFloat(BInput.value);
  let C = parseFloat(CInput.value);

  let count = [a,b,c,A,B,C].filter(x=>!isNaN(x)).length;
  if(count < 3){
    result.innerText="Du m친 fylle inn minst 3 verdier.";
    return;
  }

  let solved=false;

  // SSS
  if(!isNaN(a)&&!isNaN(b)&&!isNaN(c)){
    if(a+b<=c || a+c<=b || b+c<=a){
      result.innerText="Ugyldig trekant.";
      return;
    }
    A=cosRule(a,b,c);
    B=cosRule(b,c,a);
    C=180-A-B;
    solved=true;
  }

  // SAS
  else if(!isNaN(a)&&!isNaN(b)&&!isNaN(C)){
    c=Math.sqrt(a*a+b*b-2*a*b*Math.cos(toRad(C)));
    A=sinRule(a,c,C);
    B=180-A-C;
    solved=true;
  }
  else if(!isNaN(a)&&!isNaN(c)&&!isNaN(B)){
    b=Math.sqrt(a*a+c*c-2*a*c*Math.cos(toRad(B)));
    A=sinRule(a,b,B);
    C=180-A-B;
    solved=true;
  }
  else if(!isNaN(b)&&!isNaN(c)&&!isNaN(A)){
    a=Math.sqrt(b*b+c*c-2*b*c*Math.cos(toRad(A)));
    B=sinRule(b,a,A);
    C=180-A-B;
    solved=true;
  }

  // ASA / AAS
  else if(!isNaN(A)&&!isNaN(B)&&!isNaN(a)){
    C=180-A-B;
    b=a*Math.sin(toRad(B))/Math.sin(toRad(A));
    c=a*Math.sin(toRad(C))/Math.sin(toRad(A));
    solved=true;
  }
  else if(!isNaN(A)&&!isNaN(C)&&!isNaN(a)){
    B=180-A-C;
    b=a*Math.sin(toRad(B))/Math.sin(toRad(A));
    c=a*Math.sin(toRad(C))/Math.sin(toRad(A));
    solved=true;
  }
  else if(!isNaN(B)&&!isNaN(C)&&!isNaN(b)){
    A=180-B-C;
    a=b*Math.sin(toRad(A))/Math.sin(toRad(B));
    c=b*Math.sin(toRad(C))/Math.sin(toRad(B));
    solved=true;
  }

  if(!solved){
    result.innerText="Denne kombinasjonen kan ikke l칮ses.";
    return;
  }

  aInput.value=a;
  bInput.value=b;
  cInput.value=c;
  AInput.value=A;
  BInput.value=B;
  CInput.value=C;

  drawTriangle(a,b,c,A,B,C);
  lockInputs();
  result.innerText="Alle verdier er n친 beregnet.";
}

function clearAll(){
  unlockInputs();
  [aInput,bInput,cInput,AInput,BInput,CInput].forEach(i=>i.value="");

  const triangle = document.getElementById("triangle");
  triangle.setAttribute("points","");

  ["labelA","labelB","labelC","sidea","sideb","sidec"].forEach(id=>{
    document.getElementById(id).textContent="";
  });

  result.innerText="";
}
</script>

</body>
</html>
